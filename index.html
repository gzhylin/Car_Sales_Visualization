<!DOCTYPE html>
<!DOCTYPE html>
<meta charset="utf-8">
<html>
<head>
<script src="https://d3js.org/d3.v4.js"></script>
<script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
<style>
div.static {
  position: static;
  border: 3px solid #73AD21;
}
div.c {
  text-align: center;
}
.center {
  margin: auto;
  width: 1000px;
  border: 3px solid #b08c28;
  padding: 10px;
}
.center2 {
  margin: auto;
  width: 1000px;
  border: 3px solid #44475a;
  padding: 10px;
}
p {text-align: center;}
l {text-align: left;}
r {text-align: right;}
.dark-mode {
  background-color: #282a36;
  color: #f8f8f2;
}
</style>
</head>
<body>
<div id="time"></div>
<button onclick="myFunction()">Dark Mode</button>
<h1><p style="font-family:Helvetica;">CAR BUYING GUIDE</p></h1>
<div class="center">
<p style="font-family:Helvetica;">Car buying is never easy. New or Used they come in many 
shapes, forms and configuration. If you on the market for a used car you probably wanted
to know when the best time is to buy a car. In this Narrative Visualization we will look at
some data metrics that will help you understand car market better.
</p>
</div>
<div id="div1" style="visibility: hidden"><div class="center2"><p style="font-family:Helvetica;">  
On the Histogram below we can see Car price distribution, we can clearly see that most of the 
cars for sale will cost in the range from $5000 to $26000. We can clearly see that if 
you are on the market for a can, expect to spend on average around $16000.
<button onClick="document.getElementById('div2').scrollIntoView();">Next Visualization</button>
</p></div></div>
<div class="center">
<h3><p style="font-family:Helvetica;">Car Price Distribution Histogram</p></h3>
<div id="my_dataviz"></div>
</div>
<div id="div2" style="visibility: hidden"><div class="center2"><p style="font-family:Helvetica;">  
Another very useful Data Visualization below. Here we can see 
Car Price relative to the Car mileage. This Visualization helps us understand the relationship 
between car mileage and the price. According to the data represented here, most of the used cars 
are sold between 15000 and 50000 miles. This information helps to understand your bet options when 
shopping for a used car.

<button onClick="document.getElementById('div3').scrollIntoView();">Next Visualization</button>
</p></div></div>
<div class="center">
<h3><p style="font-family:Helvetica;">Car Price Relative to Car Mileage</p></h3>
<div id="my_dataviz2"></div>
</div>

<div id="div3" style="visibility: hidden"><div class="center2"><p style="font-family:Helvetica;">  
Finally, in the Free Exploration Plot bellow you can Zoom and find very interesting details about 
each car for sale. This plot provides details on demand and you can zoom with mouse wheel to filter 
data. Each bubble represents one car and bubble color represents actual car color. Please feel free
to explore 
</p></div></div>

<div class="center">
<h3><p style="font-family:Helvetica;">Car Price Relative to Car Mileage</p></h3>
<div id="my_dataviz3"></div>
</div>


<br>
<br>
<br>
<br>
<br>
<div class = "c">George Zhylin | July 2020 | UIUC STAT 420 </div>
<script>


var one = 0;
function startTime() {
  one = one + 1;
  document.getElementById('time').innerHTML = "Time Spent: " + one + " Seconds." ;
  t = setTimeout(function() {
    startTime()
  }, 1000);
}
startTime();

function showIt() {
  document.getElementById("div1").style.visibility = "visible";
}
setTimeout("showIt()", 3000); // after 1 sec
function showIt2() {
  document.getElementById("div2").style.visibility = "visible";
}
setTimeout("showIt2()", 5000); // after 1 sec
function showIt3() {
  document.getElementById("div3").style.visibility = "visible";
}
setTimeout("showIt3()", 8000); // after 1 sec



function myFunction() {
   var element = document.body;
   element.classList.toggle("dark-mode");
}

// set the dimensions and margins of the graph
var margin = {top: 10, right: 100, bottom: 60, left: 100},
    width = 1000 - margin.left - margin.right,
    height = 500 - margin.top - margin.bottom;
    // append the svg object to the body of the page
    var svg = d3.select("#my_dataviz")
      .append("svg")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
      .append("g")
        .attr("transform",
              "translate(" + margin.left + "," + margin.top + ")")




//Read the data
d3.csv("https://raw.githubusercontent.com/gzhylin/Nutrition-Narrative-Visualization/master/cars.csv", function(data) {


 // X axis: scale and draw:
  var x = d3.scaleLinear()
      .domain([0, 70000])     // can use this instead of 1000 to have the max of data: d3.max(data, function(d) { return +d.price })
      .range([0, width]);
  svg.append("g")
      .attr("transform", "translate(0," + height + ")")
      .call(d3.axisBottom(x));

  // set the parameters for the histogram
  var histogram = d3.histogram()
      .value(function(d) { return d.price; })   // I need to give the vector of value
      .domain(x.domain())  // then the domain of the graphic
      .thresholds(x.ticks(50)); // then the numbers of bins

  // And apply this function to data to get the bins
  var bins = histogram(data);

  // Y axis: scale and draw:
  var y = d3.scaleLinear()
      .range([height, 0]);
      y.domain([0, d3.max(bins, function(d) { return d.length; })]);   // d3.hist has to be called before the Y axis obviously
      svg.append("g")
      .call(d3.axisLeft(y));

  // X label price
  svg.append("text")
    .attr("class", "x label")
    .attr("text-anchor", "end")
    .attr("x", width  - 300)
    .attr("y", height +40)
    .text("Car Price (In US dollars)");
  // Y label Frequency 
  svg.append("text")
    .attr("class", "y label")
    .attr("text-anchor", "end")
    .attr("y", -30)
    .attr("x", -160)
    .attr("transform", "rotate(-90)")
    .text("Frequency");

  // append the bar rectangles to the svg element
  svg.selectAll("rect")
      .data(bins)
      .enter()
      .append("rect")
        .attr("x", 1)
        .attr("transform", function(d) { return "translate(" + x(d.x0) + "," + y(d.length) + ")"; })
        .attr("width", function(d) { return x(d.x1) - x(d.x0) -1 ; })
		.transition()
		.duration(4000)
        .attr("height", function(d) { return height - y(d.length); })
        .style("fill", "#6272a4")




d3.select("#circleCustomTooltip")
  .on("mouseover", function(){return tooltip2.style("visibility", "visible");})
  .on("mousemove", function(){return tooltip2.style("top", (event.pageY-2390)+"px").style("left",(event.pageX-800)+"px");})
  .on("mouseout", function(){return tooltip2.style("visibility", "hidden");});

});
</script>



<script>

// set the dimensions and margins of the graph
var margin2 = {top: 30, right: 100, bottom: 60, left: 100},
    width2 = 1000 - margin2.left - margin2.right,
    height2 = 500 - margin2.top - margin2.bottom;
    // append the svg object to the body of the page
    var svg2 = d3.select("#my_dataviz2")
      .append("svg")
        .attr("width", width2 + margin2.left + margin2.right)
        .attr("height", height2 + margin2.top + margin2.bottom)
      .append("g")
        .attr("transform",
              "translate(" + margin2.left + "," + margin2.top + ")")




//Read the data
d3.csv("https://raw.githubusercontent.com/gzhylin/Nutrition-Narrative-Visualization/master/cars.csv", function(data) {


  // Add X axis
  var x2 = d3.scaleLinear()
    .domain([0, 0])
    .range([ 0, width2 ]);
  svg2.append("g")
    .attr("class", "myXaxis")   // Note that here we give a class to the X axis, to be able to call it later and modify it
    .attr("transform", "translate(0," + height2 + ")")
    .call(d3.axisBottom(x2))
    .attr("opacity", "0")

  // Add Y axis
  var y2 = d3.scaleLinear()
    .domain([0, 200000])
    .range([ height2, 0]);
  svg2.append("g")
    .call(d3.axisLeft(y2));

  // X label price
  svg2.append("text")
    .attr("class", "x label")
    .attr("text-anchor", "end")
    .attr("x", width  - 330)
    .attr("y", height + 20)
    .text("Car Price (In US dollars)");











  // Y label Frequency 
  svg2.append("text")
    .attr("class", "y label")
    .attr("text-anchor", "end")
    .attr("y", -50)
    .attr("x", -130)
    .attr("transform", "rotate(-90)")
    .text("Car MIleage");

  // Add dots
  svg2.append('g')
    .selectAll("dot")
    .data(data)
    .enter()
    .append("circle")
      .attr("cx", function (d) { return x2(d.price); } )
      .attr("cy", function (d) { return y2(d.mileage); } )
      .attr("r", 1.5)
      .style("fill", "#6272a4")

  // new X axis
  x2.domain([0, 80000])
  svg2.select(".myXaxis")
    .transition()
    .duration(2000)
    .attr("opacity", "1")
    .call(d3.axisBottom(x2));




  svg2.selectAll("circle")
    .transition()
    .delay(function(d,i){return(i*3)})
    .duration(2000)
    .attr("cx", function (d) { return x2(d.price); } )
    .attr("cy", function (d) { return y2(d.mileage); } )
	.attr("size", "29")
    .attr("r", 4)








})

</script>


<script>

// set the dimensions and margins of the graph
var margin3 = {top: 10, right: 100, bottom: 60, left: 100},
    width3 = 1000 - margin3.left - margin3.right,
    height3 = 500 - margin3.top - margin3.bottom;
    // append the svg object to the body of the page
// append the SVG object to the body of the page
var svg3 = d3.select("#my_dataviz3")
  .append("svg")
    .attr("width", width3 + margin3.left + margin3.right)
    .attr("height", height3 + margin3.top + margin3.bottom)
    .call(d3.zoom().on("zoom", function () {
       svg3.attr("transform", d3.event.transform)
    }))
  .append("g")
    .attr("transform",
          "translate(" + margin3.left + "," + margin3.top + ")");




//Read the data
d3.csv("https://raw.githubusercontent.com/gzhylin/Nutrition-Narrative-Visualization/master/cars.csv", function(data) {

  // ---------------------------//
  //       AXIS  AND SCALE      //
  // ---------------------------//

  // Add X axis
  var x3 = d3.scaleLinear()
    .domain([0, 100000])
    .range([ 0, width3 ]);
  svg3.append("g")
    .attr("transform", "translate(0," + height3 + ")")
    .call(d3.axisBottom(x3).ticks(10));

  // X label price
  svg3.append("text")
    .attr("class", "x label")
    .attr("text-anchor", "end")
    .attr("x", width  - 330)
    .attr("y", height + 40)
    .text("Car Price (In US dollars)");











  // Y label Frequency 
  svg3.append("text")
    .attr("class", "y label")
    .attr("text-anchor", "end")
    .attr("y", -50)
    .attr("x", -130)
    .attr("transform", "rotate(-90)")
    .text("Car MIleage");

  // Add Y axis
  var y3 = d3.scaleLinear()
    .domain([0, 200000])
    .range([ height3, 0]);
  svg3.append("g")
    .call(d3.axisLeft(y3));




  // Add a scale for bubble color
  var myColor = d3.scaleOrdinal()
    .domain(["Asia", "Europe", "Americas", "Africa", "Oceania"])
    .range(d3.schemeSet1);


svg3.append("circle").attr("cx",600).attr("cy",30).attr("r", 6).style("fill", "#404080")
svg3.append("text").attr("x", 630).attr("y", 30).text("Bubble Color Represents Car Color").style("font-size", "17px").attr("alignment-baseline","middle")
svg3.append("text").attr("x", 640).attr("y", 60).text("Please zoom with mouse wheel.").style("font-size", "15px").attr("alignment-baseline","middle")


  // ---------------------------//
  //      TOOLTIP               //
  // ---------------------------//

  // -1- Create a tooltip div that is hidden by default:
  var tooltip = d3.select("#my_dataviz3")
    .append("div")
      .style("opacity", 0)
      .attr("class", "tooltip")
      .style("background-color", "black")
      .style("border-radius", "5px")
      .style("padding", "10px")
      .style("color", "white")

  // -2- Create 3 functions to show / update (when mouse move but stay on same circle) / hide the tooltip
  var showTooltip = function(d) {
    tooltip
      .transition()
      .duration(200)
    tooltip
      .style("opacity", 1)
      .html("Car Information: Brand: " + d.brand
		  + ", Model: " + d.model 
		  + ", Year: " + d.year 
		  + ", Title: " + d.title_status 
		  + ", Mileage: " + d.mileage 
		  + ", Color: " + d.color 
		  + ", State: " + d.state )



      .style("left", "100px")
      .style("top", "100px")
  }
 // var moveTooltip = function(d) {
 //   tooltip
 //     .style("left", (d3.mouse(this)[0]+30) + "px")
 //     .style("top", (d3.mouse(this)[1]+30) + "px")
 // }
  var hideTooltip = function(d) {
    tooltip
      .transition()
      .duration(200)
      .style("opacity", 0)
  }


  // ---------------------------//
  //       HIGHLIGHT GROUP      //
  // ---------------------------//

  // What to do when one group is hovered
  var highlight = function(d){
    // reduce opacity of all groups
    d3.selectAll(".bubbles").style("opacity", .05)
    // expect the one that is hovered
    d3.selectAll("."+d).style("opacity", 1)
  }

  // And when it is not hovered anymore
  var noHighlight = function(d){
    d3.selectAll(".bubbles").style("opacity", 1)
  }


  // ---------------------------//
  //       CIRCLES              //
  // ---------------------------//

  // Add dots
  svg3.append('g')
    .selectAll("dot")
    .data(data)
    .enter()
    .append("circle")
      .attr("class", function(d) { return "bubbles " + d.mileage })
      .attr("cx", function (d) { return x3(d.price); } )
      .attr("cy", function (d) { return y3(d.mileage); } )
      .attr("r", 5)
      .style("fill", function (d) { return myColor(d.color); } )
    // -3- Trigger the functions for hover
    .on("mouseover", showTooltip )
    .on("mousemove", moveTooltip )
    .on("mouseleave", hideTooltip )



    // ---------------------------//
    //       LEGEND              //
    // ---------------------------//

    // Add legend: circles
    var valuesToShow = [10000000, 100000000, 1000000000]
    var xCircle = 390
    var xLabel = 440
    svg3
      .selectAll("legend")
      .data(valuesToShow)
      .enter()
      .append("circle")
        .attr("cx", xCircle)
        .attr("cy", function(d){ return height - 100 - z(d) } )
        .attr("r", function(d){ return z(d) })
        .style("fill", "none")
        .attr("stroke", "black")

    // Add legend: segments
    svg3
      .selectAll("legend")
      .data(valuesToShow)
      .enter()
      .append("line")
        .attr('x1', function(d){ return xCircle + z(d) } )
        .attr('x2', xLabel)
        .attr('y1', function(d){ return height - 100 - z(d) } )
        .attr('y2', function(d){ return height - 100 - z(d) } )
        .attr('stroke', 'black')
        .style('stroke-dasharray', ('2,2'))

    // Add legend: labels
    svg3
      .selectAll("legend")
      .data(valuesToShow)
      .enter()
      .append("text")
        .attr('x', xLabel)
        .attr('y', function(d){ return height - 100 - z(d) } )
        .text( function(d){ return d/1000000 } )
        .style("font-size", 10)
        .attr('alignment-baseline', 'middle')

    // Legend title
    svg3.append("text")
      .attr('x', xCircle)
      .attr("y", height - 100 +30)
      .text("Population (M)")
      .attr("text-anchor", "middle")

    // Add one dot in the legend for each name.
    var size = 20
    var allgroups = ["Asia", "Europe", "Americas", "Africa", "Oceania"]
    svg3.selectAll("myrect")
      .data(allgroups)
      .enter()
      .append("circle")
        .attr("cx", 390)
        .attr("cy", function(d,i){ return 10 + i*(size+5)}) // 100 is where the first dot appears. 25 is the distance between dots
        .attr("r", 7)
        .style("fill", function(d){ return myColor(d)})
        .on("mouseover", highlight)
        .on("mouseleave", noHighlight)

    // Add labels beside legend dots
    svg3.selectAll("mylabels")
      .data(allgroups)
      .enter()
      .append("text")
        .attr("x", 390 + size*.8)
        .attr("y", function(d,i){ return i * (size + 5) + (size/2)}) // 100 is where the first dot appears. 25 is the distance between dots
        .style("fill", function(d){ return myColor(d)})
        .text(function(d){ return d})
        .attr("text-anchor", "left")
        .style("alignment-baseline", "middle")
        .on("mouseover", highlight)
        .on("mouseleave", noHighlight)
  })
</script>













































</body>
</html>